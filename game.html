<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ãˆœì— ì˜¤í”¼ ë¦¬í”„ë ˆì‹œ ë°ì´: ì—¬ì˜ë„ QR ì±Œë¦°ì§€</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
      background: #f6f7fb;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.4rem;
    }
    .subtitle {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 1rem;
    }
    .card {
      background: #fff;
      border: 1px solid #e1e4ec;
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.03);
      margin-top: 14px;
    }
    .meta {
      font-size: 0.85rem;
      color: #777;
      margin-bottom: 8px;
    }
    .mission-title {
      font-weight: 600;
      margin-bottom: 8px;
    }
    .mission-text {
      font-size: 0.95rem;
      line-height: 1.45;
      white-space: pre-line;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-size: 1rem;
      margin-top: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      background: #2b7cff;
      color: white;
    }
    button:active {
      transform: scale(0.98);
    }
    .error {
      color: #c62828;
      font-size: 0.85rem;
      margin-top: 8px;
      display: none;
    }
    .success {
      color: #0b7a2a;
      font-size: 0.9rem;
      margin-top: 8px;
      display: none;
    }
    .team-buttons {
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .team-buttons button {
      background: #e6ebff;
      color: #1f3a93;
      flex: 1 1 45%;
    }
  </style>
</head>
<body>
  <h1>ãˆœì— ì˜¤í”¼ ë¦¬í”„ë ˆì‹œ ë°ì´</h1>
  <div class="subtitle">ì—¬ì˜ë„ QR ì±Œë¦°ì§€</div>

  <!-- ì‹œì‘ & íŒ€ ì„ íƒ ì¹´ë“œ -->
  <div id="startCard" class="card">
    <div class="mission-text">
      íŒ€ì›ë“¤ê³¼ í•¨ê»˜ ì—¬ì˜ë„ì—ì„œ ì•„ë˜ ë¯¸ì…˜ë“¤ì„ ìˆ˜í–‰í•´ ì£¼ì„¸ìš”.
      ê° ë¯¸ì…˜ì„ ì™„ë£Œí•˜ë©´, 2026ë…„ì„ ìƒì§•í•˜ëŠ” ì‚¬ìì„±ì–´ì˜
      íŒíŠ¸ ê¸€ì 3ê°œë¥¼ ëœë¤í•œ ìˆœì„œë¡œ ì–»ê²Œ ë©ë‹ˆë‹¤.

      ì¹´í˜ì— ë„ì°©í•´ì„œ ì¢…ì´ í¼ì¦(ë„¤ëª¨ ë¡œì§)ì„ í’€ê³  ë§ˆì§€ë§‰ ê¸€ì 1ê°œë¥¼ ë” ì–»ì€ ë’¤,
      ì´ í˜ì´ì§€ì—ì„œ ìµœì¢… 4ê¸€ì ì‚¬ìì„±ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.
    </div>

    <div class="meta" style="margin-top:10px;">ë¨¼ì € íŒ€ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>
    <div class="team-buttons">
      <button data-team="A">AíŒ€</button>
      <button data-team="B">BíŒ€</button>
      <button data-team="C">CíŒ€</button>
      <button data-team="D">DíŒ€</button>
    </div>
  </div>

  <!-- ë¯¸ì…˜ ì¹´ë“œ -->
  <div id="missionCard" class="card" style="display:none;">
    <div class="meta" id="missionMeta"></div>
    <div class="mission-title" id="missionTitle"></div>
    <div class="mission-text" id="missionText"></div>

    <div id="answerBlock" style="margin-top:10px;">
      <input id="answerInput" type="text" placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" />
    </div>

    <button id="nextBtn">ì •ë‹µ ì œì¶œ</button>
    <div id="errorMsg" class="error"></div>
    <div id="successMsg" class="success"></div>
  </div>

  <!-- ìµœì¢… ì •ë‹µ ì…ë ¥ ì¹´ë“œ -->
  <div id="finalCard" class="card" style="display:none;">
    <div class="mission-title">ìµœì¢… 4ê¸€ì ì‚¬ìì„±ì–´ ì…ë ¥</div>
    <div class="mission-text">
      ì•¼ì™¸ ë¯¸ì…˜ 3ê°œ + ì¢…ì´ í¼ì¦ë¡œ ì–»ì€ 4ê°œì˜ ê¸€ìë¥¼ ì¡°í•©í•´
      ìµœì¢… ì‚¬ìì„±ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.
    </div>

    <input id="finalAnswerInput" type="text" placeholder="ì˜ˆ: ì¼ì·¨ì›”ì¥" style="margin-top:12px;" />
    <button id="finalSubmitBtn">ì •ë‹µ ì œì¶œ</button>

    <div id="finalError" class="error"></div>
  </div>

  <!-- ìµœì¢… ì •ë‹µ ì˜ë¯¸ ì¹´ë“œ -->
  <div id="finalMeaningCard" class="card" style="display:none;">
    <div class="mission-title">ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰</div>
    <div class="mission-text" id="finalMeaning"></div>
  </div>

  <script>
    // -----------------------------
    // 0) ì‚¬ìì„±ì–´ ì„¤ì •: é¦¬ä¸åœè¹„ (ë§ˆë¶€ì •ì œ)
    //    - ì›¹ ì •ë‹µì€ í•œê¸€ "ë§ˆë¶€ì •ì œ" ê¸°ì¤€
    //    - 'ë§ˆ'ëŠ” ì¢…ì´ ë„¤ëª¨ë¡œì§ í¼ì¦ì—ì„œ ì£¼ëŠ” ê¸€ì (ì›¹ ë¯¸ì…˜ì—ì„œëŠ” ì•ˆ ë‚˜ì˜´)
    // -----------------------------
    const FINAL_ANSWER = "ë§ˆë¶€ì •ì œ";

    // íŒ€ë³„ ë¯¸ì…˜ ìˆœì„œ (0,1,2ëŠ” MISSIONS ë°°ì—´ ì¸ë±ìŠ¤)
    const TEAM_ROUTES = {
      "A": [0, 1, 2],
      "B": [1, 2, 0],
      "C": [2, 0, 1],
      "D": [1, 0, 2]
    };

    // -----------------------------
    // 1) ë¯¸ì…˜ ë°ì´í„° ì •ì˜
    // -----------------------------
    const MISSIONS = [
      {
        // 1. í•œê°• ë‹¤ë¦¬ ê°œìˆ˜
        title: "ë¯¸ì…˜ 1 - í•œê°• ë‹¤ë¦¬ í€´ì¦ˆ",
        text:
"í•œê°•ì—ëŠ” ì´ ëª‡ ê°œì˜ ë‹¤ë¦¬ê°€ ìˆì„ê¹Œìš”?\n" +
"ìˆ«ìë§Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.",
        answer: "33",
        letter: null // ë‚˜ì¤‘ì— 'ë¶€/ì •/ì œ' ì¤‘ í•˜ë‚˜ ëœë¤ ë°°ì •
      },
      {
        // 2. ì¸ì–´ê³µì£¼ ê³„ë‹¨ ê°œìˆ˜
        title: "ë¯¸ì…˜ 2 - ì¸ì–´ê³µì£¼ ê³„ë‹¨ ìˆ˜",
        text:
"'í•œê°•ì—ì„œ ë§Œë‚œ ì¸ì–´ê³µì£¼' ë™ìƒ ì •ë©´ì— ìˆëŠ” ê³„ë‹¨ì€\n" +
"ì´ ëª‡ ê°œì¼ê¹Œìš”?\n\n" +
"ê³„ë‹¨ì„ ì„¸ì–´ ë³¸ ë’¤, ìˆ«ìë§Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.",
        answer: "8",
        letter: null
      },
      {
        // 3. ëŒì‚¬ë¥´ ìŠµì§€
        title: "ë¯¸ì…˜ 3 - ë°¤ì„¬ ìŠµì§€ í€´ì¦ˆ",
        text:
"í•œê°• ë°¤ì„¬ì€ 2012ë…„, êµ­ì œì ìœ¼ë¡œ í¬ê·€í•œ ë„ì‹œ ë‚´ë¶€ ìŠµì§€ë¡œ í‰ê°€ë°›ì•„\n" +
"'ã…‡ã…‡ã…‡ ìŠµì§€'ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n" +
"ì—¬ê¸°ì„œ ã…‡ã…‡ã…‡ì— ë“¤ì–´ê°ˆ ë§ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
        answer: "ëŒì‚¬ë¥´",
        letter: null
      }
    ];

    // -----------------------------
    // 2) DOM ìš”ì†Œ
    // -----------------------------
    const startCard   = document.getElementById("startCard");
    const teamButtons = document.querySelectorAll(".team-buttons button");

    const missionCard = document.getElementById("missionCard");
    const missionMeta = document.getElementById("missionMeta");
    const missionTitle= document.getElementById("missionTitle");
    const missionText = document.getElementById("missionText");
    const answerInput = document.getElementById("answerInput");
    const nextBtn     = document.getElementById("nextBtn");
    const errorMsg    = document.getElementById("errorMsg");
    const successMsg  = document.getElementById("successMsg");

    const finalCard        = document.getElementById("finalCard");
    const finalAnswerInput = document.getElementById("finalAnswerInput");
    const finalSubmitBtn   = document.getElementById("finalSubmitBtn");
    const finalError       = document.getElementById("finalError");

    const finalMeaningCard = document.getElementById("finalMeaningCard");
    const finalMeaning     = document.getElementById("finalMeaning");

    // -----------------------------
    // 3) ìƒíƒœê°’
    // -----------------------------
    let currentTeam   = null;
    let currentStep   = 0;      // íŒ€ ë£¨íŠ¸ ë‚´ì—ì„œ ëª‡ ë²ˆì§¸ ë¯¸ì…˜ì¸ì§€
    let collectedLetters = [];  // íŒíŠ¸ë¡œ ë°›ì€ ê¸€ìë“¤ (ë¶€/ì •/ì œ 3ê°œ)
    let isTransitioning = false;

    // -----------------------------
    // 4) ë°°ì—´ ì…”í”Œ ìœ í‹¸
    // -----------------------------
    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // -----------------------------
    // 5) ê²Œì„ ì´ˆê¸°í™” (ì›¹ íŒíŠ¸ ê¸€ì ëœë¤ ë°°ì •)
    //    - ì›¹ì—ì„œëŠ” 'ë¶€/ì •/ì œ'ë§Œ ì‚¬ìš©
    //    - 'ë§ˆ'ëŠ” ì¢…ì´ í¼ì¦ ì „ìš©
    // -----------------------------
    function initGame() {
      const webLetters = ["ë¶€", "ì •", "ì œ"]; // ì›¹ì—ì„œ ì“¸ ê¸€ìë“¤
      shuffleArray(webLetters);

      for (let i = 0; i < MISSIONS.length; i++) {
        MISSIONS[i].letter = webLetters[i];
      }

      // ì¢…ì´ í¼ì¦ìš© ê¸€ì
      const paperLetter = "ë§ˆ";
      // console.log("ì›¹ì—ì„œ ì“°ëŠ” ê¸€ìë“¤:", webLetters);
      // console.log("ì¢…ì´ í¼ì¦ìš© ê¸€ì:", paperLetter);
    }

    // -----------------------------
    // 6) íŒ€ ì„ íƒ â†’ ê²Œì„ ì‹œì‘
    // -----------------------------
    function startGameForTeam(team) {
      if (!TEAM_ROUTES[team]) {
        alert("ìœ íš¨í•˜ì§€ ì•Šì€ íŒ€ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        return;
      }
      currentTeam = team;
      currentStep = 0;
      collectedLetters = [];
      isTransitioning = false;

      initGame();

      startCard.style.display = "none";
      missionCard.style.display = "block";
      finalCard.style.display = "none";
      finalMeaningCard.style.display = "none";

      showMission();
    }

    teamButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const team = btn.getAttribute("data-team");
        startGameForTeam(team);
      });
    });

    // -----------------------------
    // 7) í˜„ì¬ ë¯¸ì…˜ í‘œì‹œ
    // -----------------------------
    function showMission() {
      const route = TEAM_ROUTES[currentTeam];

      // ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ â†’ ìµœì¢… ì •ë‹µ ì…ë ¥ ì¹´ë“œë¡œ ì´ë™
      if (currentStep >= route.length) {
        missionCard.style.display = "none";
        finalCard.style.display = "block";
        finalError.style.display = "none";
        finalAnswerInput.value = "";
        return;
      }

      const missionIndex = route[currentStep];
      const mission = MISSIONS[missionIndex];

      missionMeta.textContent  = `${currentStep + 1} / ${route.length} ë‹¨ê³„ (${currentTeam}íŒ€)`;
      missionTitle.textContent = mission.title;
      missionText.textContent  = mission.text;

      errorMsg.style.display   = "none";
      successMsg.style.display = "none";
      nextBtn.textContent      = "ì •ë‹µ ì œì¶œ";
      answerInput.value        = "";
      isTransitioning          = false;
    }

    // -----------------------------
    // 8) ë¯¸ì…˜ ì •ë‹µ ì œì¶œ
    //    - ì •ë‹µì´ë©´ ê¸€ì 1ê°œ ë³´ì—¬ì£¼ê³ , ì ì‹œ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
    // -----------------------------
    nextBtn.addEventListener("click", () => {
      if (isTransitioning) {
        return;
      }

      const route = TEAM_ROUTES[currentTeam];
      const missionIndex = route[currentStep];
      const mission = MISSIONS[missionIndex];

      const userAnswerRaw = (answerInput.value || "").trim();
      if (!userAnswerRaw) {
        errorMsg.textContent = "ì •ë‹µì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        errorMsg.style.display = "block";
        successMsg.style.display = "none";
        return;
      }

      const normalize = (s) => s.replace(/\s+/g, "").toLowerCase();
      const userAnswer = normalize(userAnswerRaw);
      const correct    = normalize(mission.answer || "");

      if (userAnswer !== correct) {
        errorMsg.textContent = "ì •ë‹µì´ ì•„ë‹™ë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ ì£¼ì„¸ìš”!";
        errorMsg.style.display = "block";
        successMsg.style.display = "none";
        return;
      }

      // ì •ë‹µì¼ ë•Œ â†’ ì´ë²ˆ ë¯¸ì…˜ì—ì„œ ë°°ì •ëœ ê¸€ì íšë“
      const letter = mission.letter;
      collectedLetters.push(letter);

      errorMsg.style.display   = "none";
      successMsg.style.display = "block";
      successMsg.textContent   = `ì •ë‹µì…ë‹ˆë‹¤! ì´ë²ˆ ë¯¸ì…˜ìœ¼ë¡œ ì–»ì€ ê¸€ì: "${letter}" (ê¸°ì–µí•´ ë‘ì„¸ìš”)`;

      isTransitioning = true;
      nextBtn.textContent = "ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™ ì¤‘...";

      setTimeout(() => {
        currentStep += 1;
        showMission();
      }, 1500);
    });

    // í€´ì¦ˆ ì…ë ¥ì¹¸ ì—”í„°í‚¤ë¡œ ì œì¶œ
    answerInput.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        nextBtn.click();
      }
    });

    // -----------------------------
    // 9) ìµœì¢… ì‚¬ìì„±ì–´ ì •ë‹µ ì œì¶œ
    // -----------------------------
    finalSubmitBtn.addEventListener("click", () => {
      const normalize = (s) => s.replace(/\s+/g, "").trim();
      const userAnswer = normalize(finalAnswerInput.value || "");
      const correct    = normalize(FINAL_ANSWER);

      if (!userAnswer) {
        finalError.textContent = "ìµœì¢… 4ê¸€ìë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        finalError.style.display = "block";
        return;
      }

      if (userAnswer !== correct) {
        finalError.textContent = "ì •ë‹µì´ ì•„ë‹™ë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ ì£¼ì„¸ìš”.";
        finalError.style.display = "block";
        return;
      }

      // ì •ë‹µì¼ ë•Œ
      finalError.style.display = "none";
      finalCard.style.display  = "none";

      finalMeaning.innerHTML = `
        <b>é¦¬ä¸åœè¹„(ë§ˆë¶€ì •ì œ)</b><br><br>
        2026ë…„ì€ ë³‘ì˜¤ë…„, ë¶‰ì€ ë§ì˜ í•´ì…ë‹ˆë‹¤.<br>
        é¦¬ä¸åœè¹„(ë§ˆë¶€ì •ì œ)ëŠ” ë§ì´ ë°œêµ½ì„ ë©ˆì¶”ì§€ ì•Šê³ <br>
        ì‰¼ ì—†ì´ ë‹¬ë¦¬ëŠ” ëª¨ìŠµì—ì„œ ë‚˜ì˜¨ ë§ë¡œ,<br>
        ì ì‹œë„ ë¨¸ë­‡ê±°ë¦¬ì§€ ì•Šê³  ëŠì„ì—†ì´ ë‚˜ì•„ê°€ëŠ” íƒœë„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.<br><br>
        2026ë…„ í•œ í•´ ë™ì•ˆ ãˆœì— ì˜¤í”¼ê°€<br>
        ë©ˆì¶”ì§€ ì•ŠëŠ” ë§ì²˜ëŸ¼ ê³„ì†í•´ì„œ ë„ì „í•˜ê³ ,<br>
        ì„±ì¥ì˜ ì†ë„ë¥¼ ëŠ¦ì¶”ì§€ ì•Šê² ë‹¤ëŠ” ë‹¤ì§ì„ ë‹´ì•„<br>
        ì´ ì‚¬ìì„±ì–´ë¥¼ ì„ ì •í–ˆìŠµë‹ˆë‹¤.<br><br>
        ì˜¤ëŠ˜ ë¦¬í”„ë ˆì‹œ ë°ì´ì—ì„œ ì¶©ì „í•œ ì—ë„ˆì§€ë¥¼ ë°”íƒ•ìœ¼ë¡œ,<br>
        ê°ìì˜ ìë¦¬ì—ì„œ í˜ì°¨ê²Œ ì•ìœ¼ë¡œ ë‹¬ë ¤ê°€ ë³´ì•„ìš”. ğŸ
      `;
      finalMeaningCard.style.display = "block";
    });

    // ìµœì¢… ì •ë‹µ ì…ë ¥ì¹¸ ì—”í„°í‚¤ë¡œ ì œì¶œ
    finalAnswerInput.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        finalSubmitBtn.click();
      }
    });
  </script>
</body>
</html>
